# Инструкция по использованию скрипта для анализа направлений обучения

## Общие сведения

Скрипт предназначен для автоматизации обработки данных о направлениях и профилях обучения в таблицах Google Sheets. Он выполняет следующие функции:

1. Автоматически находит в таблице листы с данными очной и заочной формы обучения
2. Находит столбцы, содержащие информацию о направлениях
3. Извлекает из текста коды направлений, их названия и профили
4. Нормализует данные, исправляя распространенные ошибки и опечатки
5. Генерирует отчет с группировкой по направлениям, профилям и формам обучения
6. Выполняет проверку данных на соответствие официальному словарю и сообщает о проблемах

## Установка

1. Откройте вашу таблицу Google Sheets
2. В меню выберите **Расширения** > **Apps Script**
3. В открывшемся редакторе скриптов удалите весь код в файле Code.gs
4. Создайте следующие файлы, скопировав в них соответствующий код:
   - `DirectionsAnalysis.gs` - основной файл скрипта
   - `TextProcessing.gs` - функции обработки текста
   - `DirectionsMap.gs` - словарь направлений и профилей
   - `SheetUtilities.gs` - функции для работы с листами
   - `DataProcessing.gs` - функции обработки данных
   - `ReportGeneration.gs` - функции генерации отчетов
5. Сохраните проект (Ctrl+S или Cmd+S)

## Использование

### Подготовка данных

1. Убедитесь, что ваша таблица содержит листы с данными очной и/или заочной формы обучения
2. Рекомендуется, чтобы названия листов содержали соответствующие ключевые слова ("очная", "дневная", "заочная" и т.д.)
3. В таблице должны быть столбцы, содержащие информацию о направлениях в формате "XX.XX.XX Название направления (Профиль)"

### Запуск скрипта

1. Обновите страницу с таблицей, чтобы появилось новое меню
2. В меню выберите **Анализ направлений** > **Запустить анализ**
3. При первом запуске Google может запросить разрешения - разрешите скрипту доступ к таблице
4. Дождитесь завершения анализа (это может занять несколько секунд в зависимости от объема данных)

### Результаты

После завершения анализа в таблице будут созданы два новых листа:

1. **Отчёт по направлениям** - содержит структурированную информацию о направлениях, профилях и формах обучения с группировкой и подсчетом количества
2. **Лог** - содержит информацию о потенциальных проблемах с данными и рекомендации по их исправлению

## Особенности работы скрипта

### Поиск листов

Скрипт автоматически ищет листы с очной и заочной формой обучения по следующим ключевым словам:
- Для очной формы: "очная", "очники", "очка", "очное", "дневная", "дневное", "дневники" и т.д.
- Для заочной формы: "заочная", "заочники", "заочка", "заочное", "вечернее", "вечерка" и т.д.

Если листы не найдены, скрипт использует первые два листа таблицы.

### Поиск столбцов с направлениями

Скрипт находит столбцы с информацией о направлениях следующими способами:
1. По ключевым словам в заголовках: "направление", "специальность", "профиль" и т.д.
2. По содержимому ячеек: ищет шаблоны вида "XX.XX.XX" (код направления)
3. Если ничего не найдено, использует стандартные столбцы I, J, K, L, M

### Обработка направлений и профилей

Скрипт извлекает из текста:
1. Код направления в формате XX.XX.XX (поддерживаются разные разделители: точки, запятые, дефисы)
2. Профиль, который может быть указан в круглых скобках () или после названия направления
3. Текст в квадратных скобках [] игнорируется и рассматривается как комментарии пользователя

Данные нормализуются:
1. Приводятся к стандартному виду
2. Исправляются распространенные ошибки (смешивание русских и английских букв, лишние пробелы и т.д.)
3. **Автоматически расшифровываются заданные сокращения** (например, "ис" заменится на "информационные системы"). Чтобы добавить свои сокращения:
   - Откройте файл `TextProcessing.gs` в редакторе скриптов.
   - Найдите функцию `normalizeText`.
   - Внутри этой функции найдите объект `abbreviations`.
   - Добавьте новую строку в формате `"сокращение": "полная форма",` (важно указать сокращение в нижнем регистре).
4. Проверяются на соответствие официальному словарю направлений и профилей

## Устранение проблем

### Скрипт не находит нужные листы

Проверьте названия листов. Рекомендуется добавить в названия ключевые слова "очная" или "заочная".

### Скрипт не находит направления в столбцах

Убедитесь, что направления указаны в формате "XX.XX.XX Название направления". Если данные расположены в нестандартных столбцах, добавьте в заголовки ключевые слова "направление" или "специальность".

### В отчете указан профиль "Без указания профиля"

Это означает, что скрипт не смог извлечь профиль из текста. Рекомендуется указывать профиль в круглых скобках () после названия направления или после фразы "профиль:". Помните, что текст в квадратных скобках [] обрабатывается как комментарий и игнорируется.

### В логе есть предупреждения о ненайденных направлениях

Проверьте правильность кодов направлений. Если код верный, но направление новое и отсутствует в словаре, обратитесь к администратору для обновления словаря.

## Дополнительная информация

Скрипт использует официальный словарь направлений и профилей, который поддерживается в актуальном состоянии. Если вы заметили неточности или изменения в названиях направлений и профилей, обратитесь к администратору для обновления словаря. 